# 四柱推命における干合・支合のルール

## 1. 干合（かんごう）の関係

干合とは、天干どうしの相性関係のことで、ある天干と別の天干が組み合わさることを指します。十干を並べた時にある十干からそこから数えて6番目の十干との組み合わせとなります。これらは五行では相剋の関係にあたりますが、十干同士はとても結びつきが強いため、剋し合う（弱め合う）関係にはなりません。

### 干合の基本関係
- 甲（木）+ 己（土）→ 甲が戊に変化（己は不変）
- 乙（木）+ 庚（金）→ 乙が辛に変化（庚は不変）
- 丙（火）+ 辛（金）→ 丙が壬に変化（辛は不変）
- 丁（火）+ 壬（水）→ 丁が乙に変化（壬は甲に変化）
- 戊（土）+ 癸（水）→ 戊が丙に変化（癸は丁に変化）

### 干合によって何が変化するか
- 甲（木）→ 戊（土）：土の力量が強まる
- 乙（木）→ 辛（金）：金の力量が強まる
- 丙（火）→ 壬（水）：水の力量が強まる
- 丁（火）→ 乙（木）：木の力量が強まる
- 戊（土）→ 丙（火）：火の力量が強まる
- 癸（水）→ 丁（火）：火の力量が強まる
- 壬（水）→ 甲（木）：木の力量が強まる

### 干合の成立条件
1. 命式の中で干合が成立するのは、天干のうち「年と月」、「月と日」、「日と時」という隣り合った3か所だけです。
2. 例：年干が「甲」で日干が「己」の場合は、隣り合わないので干合にはなりません。
3. 干合するのは、プラスαの変化の条件を満たし、姻合（妬合）がない場合のみです。

### 実装時の注意事項
干合が発生すると、天干が変化する前の元の天干を保存しておく必要があります。これは、後続の処理（特に十神関係の計算など）で、元の天干を参照する場合があるためです。SajuEngineでは、干合処理を実行する前に、まず元の天干を`originalStem`プロパティに保存してから変換を行います。

```typescript
// 実装例（SajuEngine.tsの一部）
// オリジナルの天干を保存
fourPillarsBeforeCombination.yearPillar.originalStem = yearPillar.stem;
fourPillarsBeforeCombination.monthPillar.originalStem = monthPillar.stem;
fourPillarsBeforeCombination.dayPillar.originalStem = dayPillar.stem;
fourPillarsBeforeCombination.hourPillar.originalStem = hourPillar.stem;

// 干合・支合の処理を適用
const fourPillarsAfterCombination = applyGanShiCombinations(fourPillarsBeforeCombination);
```

## 2. 支合（しごう）の関係

支合とは、五行を強める十二支の組み合わせです。

### 支合の関係図
```
子（水）←→ 丑（土）：土の力量が強まる（子丑合化土）
寅（木）←→ 亥（水）：木の力量が強まる（寅亥合化木）
卯（木）←→ 戌（土）：火の力量が強まる（卯戌合化火）
辰（土）←→ 酉（金）：金の力量が強まる（辰酉合化金）
巳（火）←→ 申（金）：水の力量が強まる（巳申合化水）
午（火）←→ 未（土）：火の力量が強まる（午未合化火）
```

### 支合の特徴
1. 支合が成立すると、地支が帯びる五行の力量が変化します（十二支が別の十二支に変わるわけではありません）。
2. 命式の中で支合が成立するのは、地支のうち「年と月」、「月と日」、「日と時」の隣り合った3か所です。
3. 単に支合があるだけでは命式は変化せず、さらに「プラスαの変化の条件」を満たしていることが必要です。

## 3. 姻合（妬合）の関係

姻合（妬合）とは、1つの天干が両隣の天干から同時に干合されることをいいます。

### 姻合の特徴
1. 姻合は結びつきの力が弱まるため、干合しても変化しません。
2. 例：「己・甲・己」の場合、中央の「甲」が両側の「己」から干合されるため変化しません。

### 姻合の例
例：1989年10月16日生まれの人の場合
- 天干：「己（土）・甲（木）・己（土）」
- 両方から干合を受けるため変化しない

## 4. 支冲（しちゅう）の関係

支冲とは、ある地支とそこから時計回りに数えて7番目の地支の関係で、互いに反発し合います。

### 支冲の組み合わせ
- 子（水）↔︎ 午（火）
- 丑（土）↔︎ 未（土）
- 寅（木）↔︎ 申（金）
- 卯（木）↔︎ 酉（金）
- 辰（土）↔︎ 戌（土）
- 巳（火）↔︎ 亥（水）

### 支冲の特徴
1. 隣り合った地支に支冲があると、支合があっても変化しません。
2. 例：地支に「丑・子・午」が並んだ場合、「子・丑」は支合となりますが、「子・午」の冲が同時にあるため変化しません。

## 5. プラスαの変化の条件

それぞれの組み合わせで以下の条件を満たすと変化します：

### 合化土（甲己の干合）
- 月支に土の気の干支（戊・己・丑・辰・未・戌）が多い、かつ
- 命式に木の気の干支（甲・乙・寅・卯）がない（干合する場合は除く）
- 結果：甲は戊に変化する（己は不変）

### 合化金（乙庚の干合）
- 月支に金の気の干支（庚・辛・申・酉）が多い、かつ
- 命式に火の気の干支（丙・丁・巳・午）がない
- 結果：乙は辛に変化する（庚は不変）

### 合化水（丙辛の干合）
- 月支に水の気の干支（壬・癸・子・亥）が多い、かつ
- 命式に土の気の干支（戊・己・丑・辰・未・戌）がない
- 結果：丙は壬に変化する（辛は不変）

### 合化木（丁壬の干合）
- 月支に木の気の干支（甲・乙・寅・卯）が多い、かつ
- 命式に金の気の干支（庚・辛・申・酉）がない
- 結果：丁は乙に変化する、壬は甲に変化する

### 合化火（戊癸の干合）
- 月支に火の気の干支（丙・丁・巳・午）が多い、かつ
- 命式に水の気の干支（壬・癸・子・亥）がない
- 結果：戊は丙に変化する、癸は丁に変化する

### 子・丑合化土
- 子と丑の天干には戊・己・丑・辰・未・戌があり、かつ
- 命式に木の気の干支（甲・乙・寅・卯）がない
- 結果：土の力量が強まる

### 寅・亥合化木
- 寅と亥の天干には甲・乙・寅・卯があり、かつ
- 命式に金の気の干支（庚・辛・申・酉）がない
- 結果：木の力量が強まる

### 卯・戌合化火
- 卯と戌の天干には丙・丁・巳・午があり、かつ
- 命式に水の気の干支（壬・癸・子・亥）がない
- 結果：火の力量が強まる

### 辰・酉合化金
- 辰と酉の天干には庚・辛・申・酉があり、かつ
- 命式に火の気の干支（丙・丁・巳・午）がない
- 結果：金の力量が強まる

### 巳・申合化水
- 巳と申の天干には壬・癸・子・亥があり、かつ
- 命式に土の気の干支（戊・己・丑・辰・未・戌）がない
※月支の巳、辰は除く
- 結果：水の力量が強まる

### 午・未合化火
- 午と未の天干には丙・丁・甲・乙があり、かつ
- 命式に水の気の干支（壬・癸・子・亥）がない
- 結果：火の力量が強まる

## 6. 変化しない場合

以下の場合は変化しません：

1. 姻合（妬合）が成立する場合（1つの天干が両隣から干合される）
2. 1つの地支が両隣の地支から同時に支合される場合
3. 隣り合った地支に支冲がある場合
4. 干合や支合の特殊条件を満たしていない場合

## 7. 実例による説明

### 命式の変化例
天干を確認すると、日干の「甲」と月干の「己」が干合していて、さらに月支が「丑」である場合、命式に土の気の干支（戊・己・丑・辰）が多く、干合する日干の「甲」以外に木の気の干支がない場合には、「甲」が「戊」に変化します。このように、干合の条件と実際の命式の構成要素によって変化が決まります。

## 8. 重要ポイント

1. 干合・支合の関係を確認する際は、必ず隣り合った柱（年月・月日・日時）の関係を見ます。
2. 干合・支合があっても特殊条件を満たしていなければ変化しません。
3. 姻合（妬合）や支冲があると、干合・支合の効果が打ち消されます。
4. 干合や支合を確認する際は、くっつく関係にあるかどうかを見るだけでなく、条件を満たすかどうかもしっかり確認する必要があります。
5. 命式の変化を正確に把握することで、より的確な四柱推命の鑑定が可能になります。